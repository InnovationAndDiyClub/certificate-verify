<script>
  const params = new URLSearchParams(window.location.search);
  const enroll = params.get("enroll");

  if (!enroll) {
    document.getElementById("result").innerHTML = "❌ Enrollment missing in QR";
  } else {
    fetch("https://script.google.com/macros/s/AKfycbzYPMYuBJuIF4AtxgGDA57DHnppSSxK42QDVeeli8kf0Qa9XI-LVxcKgxFk5FjeJ-HV/exec?enroll=" + enroll)
      .then(res => res.json())
      .then(data => {
        if (data.status === "VALID") {
          document.getElementById("result").innerHTML = `
            ✅ <b>Certificate Verified</b><br><br>
            Name: ${data.name}<br>
            Enrollment: ${data.enrollment}<br>
            Branch: ${data.branch}<br>
            Year: ${data.year}
          `;
        } else {
          document.getElementById("result").innerHTML = "❌ Invalid Certificate";
        }
      })
      .catch(() => {
        document.getElementById("result").innerHTML = "❌ Verification failed";
      });
  }
</script>
